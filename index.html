<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PDF ‚Üí DOCX Âú®Á∫øËΩ¨Êç¢</title>

  <style>
    /* --- Reset --- */
    * { margin:0; padding:0; box-sizing:border-box; }

    :root {
      --bg: #f5f7fa;
      --card: #ffffff;
      --text: #222;
      --text-light: #666;
      --primary: #4f46e5;
      --primary-dark: #3730a3;
      --border: #e5e7eb;
    }

    /* Ê∑±Ëâ≤Ê®°ÂºèÂèòÈáè */
    body.dark {
      --bg: #111827;
      --card: #1f2937;
      --text: #f3f4f6;
      --text-light: #d1d5db;
      --border: #374151;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      transition: background 0.3s, color 0.3s;
    }

    .container {
      max-width: 650px;
      margin: 80px auto;
      padding: 0 20px;
    }

    .card {
      background: var(--card);
      border-radius: 12px;
      padding: 40px 30px;
      box-shadow: 0 4px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--border);
      transition: background 0.3s, border 0.3s;
    }

    /* È°∂ÈÉ® LOGO */
    .logo {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:12px;
      margin-bottom:20px;
      font-size:26px;
      font-weight:600;
    }

    .logo img {
      width:40px;
      height:40px;
    }

    input[type=file] {
      margin: 20px 0;
      width:100%;
    }

    button {
      width:100%;
      padding:12px;
      font-size:1.1em;
      border:none;
      border-radius:6px;
      background: var(--primary);
      color:white;
      cursor:pointer;
      transition: background 0.2s, opacity 0.2s;
    }

    button:hover { background: var(--primary-dark); }

    button:disabled {
      opacity:0.6;
      cursor:not-allowed;
    }

    /* ËΩ¨Êç¢ËøõÂ∫¶Êù° */
    .progress {
      width:100%;
      height:6px;
      background:#d1d5db;
      border-radius:4px;
      overflow:hidden;
      margin: 15px 0;
      display:none;
    }

    .progress-bar {
      height:100%;
      width:0%;
      background: var(--primary);
      transition: width 0.3s ease;
    }

    /* ÂéÜÂè≤ËÆ∞ÂΩïÂç°Áâá */
    .history {
      margin-top:35px;
      background:var(--card);
      padding:20px;
      border-radius:10px;
      border:1px solid var(--border);
    }

    .history h3 { margin-bottom:15px; font-size:1.1em; }

    .history-item {
      padding:10px 0;
      border-bottom:1px solid var(--border);
    }
    .history-item:last-child { border-bottom:none; }

    .history-item a {
      color: var(--primary);
      text-decoration:none;
    }

    .theme-toggle {
      position:absolute;
      right:25px;
      top:25px;
      cursor:pointer;
      font-size:18px;
      color:var(--text);
    }

    footer {
      margin-top:40px;
      text-align:center;
      font-size:0.9em;
      color:var(--text-light);
    }
  </style>
</head>

<body>
  <!-- Ê∑±Ëâ≤Ê®°ÂºèÊåâÈíÆ -->
  <div class="theme-toggle" onclick="toggleTheme()">üåì</div>

  <div class="container">
    <div class="card">

      <!-- Logo -->
      <div class="logo">
        <img src="https://cdn-icons-png.flaticon.com/512/337/337946.png">
        PDF ‚Üí DOCX ËΩ¨Êç¢
      </div>

      <input type="file" id="file" accept=".pdf" />
      <button id="btn" onclick="startConvert()">ÂºÄÂßãËΩ¨Êç¢</button>

      <!-- ËøõÂ∫¶Êù° -->
      <div class="progress" id="progress">
        <div class="progress-bar" id="progress-bar"></div>
      </div>

    </div>

    <!-- ÂéÜÂè≤ËÆ∞ÂΩï -->
    <div class="history">
      <h3>ËΩ¨Êç¢ÂéÜÂè≤</h3>
      <div id="history-list"></div>
    </div>

    <footer>¬© 2025 PDF2DOCX ‚Äî Âú®Á∫øÊñáÊ°£ËΩ¨Êç¢Â∑•ÂÖ∑</footer>
  </div>

  <script src="script.js"></script>

  <script>
    /* ------------------------------
       Ê∑±Ëâ≤Ê®°ÂºèÂàáÊç¢
    ------------------------------ */
    function toggleTheme() {
      document.body.classList.toggle("dark");
      localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
    }

    if (localStorage.getItem("theme") === "dark") {
      document.body.classList.add("dark");
    }

    /* ------------------------------
       ËΩ¨Êç¢ÈÄªËæëÂÖ•Âè£ÔºàËøûÊé• script.jsÔºâ
    ------------------------------ */
    function startConvert() {
      const file = document.getElementById("file").files[0];
      if (!file) return alert("ËØ∑ÂÖàÈÄâÊã© PDF Êñá‰ª∂");

      let btn = document.getElementById("btn");
      let progress = document.getElementById("progress");
      let bar = document.getElementById("progress-bar");

      btn.disabled = true;
      btn.innerText = "Ê≠£Âú®ËΩ¨Êç¢‚Ä¶";
      progress.style.display = "block";

      // ËøõÂ∫¶Êù°Âä®ÁîªÔºàÂÅáË£ÖÂä†ËΩΩÔºâ
      let p = 0;
      let timer = setInterval(() => {
        p = Math.min(p + 8, 96);
        bar.style.width = p + "%";
      }, 200);

      // Ë∞ÉÁî®‰Ω†ÂéüÊù•ÁöÑ script.js ÂÜÖÁöÑËΩ¨Êç¢ÂáΩÊï∞
      convertPDF(file)
        .then((downloadUrl) => {
          clearInterval(timer);
          bar.style.width = "100%";

          setTimeout(() => {
            progress.style.display = "none";
            bar.style.width = "0%";
          }, 800);

          btn.disabled = false;
          btn.innerText = "ÂºÄÂßãËΩ¨Êç¢";

          onConvertSuccess(downloadUrl);
        })
        .catch(() => {
          clearInterval(timer);
          alert("ËΩ¨Êç¢Â§±Ë¥•ÔºåËØ∑ÈáçËØï");
          btn.disabled = false;
          btn.innerText = "ÂºÄÂßãËΩ¨Êç¢";
        });
    }

    /* ------------------------------
       ËΩ¨Êç¢ÊàêÂäüÂêéÂÜôÂÖ•ÂéÜÂè≤ËÆ∞ÂΩï
    ------------------------------ */
    function onConvertSuccess(url) {
      const history = JSON.parse(localStorage.getItem("history") || "[]");

      history.unshift({
        url,
        time: new Date().toLocaleString()
      });

      localStorage.setItem("history", JSON.stringify(history));
      renderHistory();
    }

    /* ------------------------------
       Ê∏≤ÊüìÂéÜÂè≤ËÆ∞ÂΩï UI
    ------------------------------ */
    function renderHistory() {
      const history = JSON.parse(localStorage.getItem("history") || "[]");
      const wrap = document.getElementById("history-list");

      wrap.innerHTML = history.map(h => `
        <div class="history-item">
          <div>Êó∂Èó¥Ôºö${h.time}</div>
          <a href="${h.url}" target="_blank">‰∏ãËΩΩ DOCX</a>
        </div>
      `).join("");
    }

    renderHistory();
  </script>
</body>
</html>

